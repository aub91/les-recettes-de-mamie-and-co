<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<title>Les recettes de Mamie & Co</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<body>

<!-- Header -->
<header class="w3-display-container" style="width:100%;height:10%;">
  <img src="/images/table-garnie-2.jpg" alt="table-garnie" style="width:100%;">
  <div class="w3-display-middle w3-jumbo w3-red w3-text-white">Les recettes de Mamie & Co</div>
</header> 

<!-- Page content -->
<div class="w3-content w3-padding" style="max-width:1564px">

  <!-- Recette Section Title-->
  <div class="w3-container w3-padding-32" id="projects">
    <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Recettes</h3>
  </div>
    
  <!-- Filter Section -->
  <div class="w3-display-container w3-padding-32">
      
      <!-- Category filter list -->
      <div class="w3-container w3-display-left" id="cat-filters">
        <input class="w3-check" type="checkbox" onclick="switchCatTag(this,'plat_principal')">
        <label>Plat principal</label>

        <input class="w3-check" type="checkbox" onclick="switchCatTag(this,'dessert')">
        <label>Dessert</label>

        <input class="w3-check" type="checkbox" onclick="switchCatTag(this,'sauce')">
        <label>Sauce</label>
    </div>
      
    <!-- Family filter list -->
    <div class="w3-container w3-display-right" id="family-filters">
        <input class="w3-check" type="checkbox" onclick="switchFamilyTag(this,'bouvier')">
        <label>Bouvier</label>

        <input class="w3-check" type="checkbox" onclick="switchFamilyTag(this,'alcover')">
        <label>Alcover</label>
    </div>    
  </div>    
  
  <!-- Recette List Section-->
  <div class="w3-row-padding">
    <div th:each="recipe : ${recipes}">


    <!-- Beginning of recipe-->  
    <div class="fiche-recette w3-third w3-container w3-margin-bottom w3-card" th:onclick="document.getElementById(${recipe.id}).style.display='block'" th:attr="tag-recette-cat=${recipe.category}, tag-recette-famille=${recipe.family}"  >
        <div class="w3-display-container">
            <img th:src="${recipe.image}" alt="Norway" style="width:100%" class="w3-hover-opacity">
            <div class="w3-display-topright">
                <span class="w3-tag w3-blue" th:text="${recipe.family}">Bouvier</span>
            </div>
            <div class="w3-display-topleft">
                <span class="w3-tag w3-red" th:text="${recipe.category}">Plat principal</span>
            </div>
        </div>
        
      <div class="w3-container w3-white">
        <p><b th:text="${recipe.title}">Lorem Ipsum</b></p>
      </div>
    </div>

    <div th:id="${recipe.id}" class="w3-modal">
      <div class="w3-modal-content">
        <div class="w3-container">
          <div class="w3-display-container">
            <img th:src="${recipe.image}" alt="Norway" style="width:100%">
            <div class="w3-display-bottomright">
                <span class="w3-tag w3-blue" th:text="${recipe.family}">Bouvier</span>
            </div>
            <div class="w3-display-bottomleft">
                <span class="w3-tag w3-red" th:text="${recipe.category}">Plat principal</span>
            </div>
          </div>
          <div class="w3-container w3-white">
            <p><b th:text="${recipe.title}">Lorem Ipsum</b></p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
            <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>  
          </div>
          <span th:onclick="document.getElementById(${recipe.id}).style.display='none'" class="w3-button w3-display-topright">&times;</span>
        </div>
      </div>
    </div>
    <!-- End of recipe-->
    </div>
      
  </div>
</div>


<!-- Footer -->
<footer class="w3-center w3-black w3-padding-16">
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>

</body>
</html>

<!-- JS Script Section. DO NOT TOUCH ! -->
<script type="text/JavaScript">
activeCatTagList=[];
activeFamilyTagList=[];
    
function switchCatTag(checkBox, tagName){
    
    if(checkBox.checked == 1){
        activeCatTagList.push(tagName);
    } else{
        removeCatTag(tagName);
    }
    showActiveRecipes();
    
}
    
function switchFamilyTag(checkBox, tagName){
    
    if(checkBox.checked == 1){
        activeFamilyTagList.push(tagName);
    } else{
        removeFamilyTag(tagName);
    }
    showActiveRecipes();
    
}
    
function removeCatTag(tagName){
    var index = activeCatTagList.indexOf(tagName);
 
    if (index > -1) {
        activeCatTagList.splice(index, 1);
    }
}
    
function removeFamilyTag(tagName){
    var index = activeFamilyTagList.indexOf(tagName);
 
    if (index > -1) {
        activeFamilyTagList.splice(index, 1);
    }
}
    
function showActiveRecipes(){
    let recipes = document.getElementsByClassName('fiche-recette')
    
    if (activeCatTagList.length == 0 && activeFamilyTagList.length == 0){
        for(recipe of recipes){
            recipe.style.display = "block";
        }  
    } else{
        for(recipe of recipes){
            if(mustBeDiplayed(recipe)){
                recipe.style.display = "block";
            } else {
                recipe.style.display = "none";
            }
        }
    }
}
    
function mustBeDiplayed(recipe){
    let catOK = true;
    let familyOK = true;
    if(activeCatTagList.length != 0){
        catOK = activeCatTagList.includes(recipe.getAttribute("tag-recette-cat"));
    }
    if(activeFamilyTagList.length != 0){
        familyOK = activeFamilyTagList.includes(recipe.getAttribute("tag-recette-famille"));
    }
    return catOK && familyOK;
}
</script>
